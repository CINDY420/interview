

- [浏览器的进程和线程](#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B)
  - [基础概念](#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5)
    - [**进程**](#%E8%BF%9B%E7%A8%8B)
    - [**线程**](#%E7%BA%BF%E7%A8%8B)
    - [关于两者](#%E5%85%B3%E4%BA%8E%E4%B8%A4%E8%80%85)
    - [多线程 & 多进程](#%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%A4%9A%E8%BF%9B%E7%A8%8B)
  - [浏览器是多进程的](#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A4%9A%E8%BF%9B%E7%A8%8B%E7%9A%84)
    - [主要包含哪些进程？](#%E4%B8%BB%E8%A6%81%E5%8C%85%E5%90%AB%E5%93%AA%E4%BA%9B%E8%BF%9B%E7%A8%8B%EF%BC%9F)
    - [多进程的优势](#%E5%A4%9A%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%BC%98%E5%8A%BF)
    - [注意](#%E6%B3%A8%E6%84%8F)
  - [浏览器内核是多线程的](#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E6%A0%B8%E6%98%AF%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84)
    - [GUI 渲染线程](#gui-%E6%B8%B2%E6%9F%93%E7%BA%BF%E7%A8%8B)
    - [Javascript引擎线程](#javascript%E5%BC%95%E6%93%8E%E7%BA%BF%E7%A8%8B)
  - [参考](#%E5%8F%82%E8%80%83)

# 浏览器的进程和线程

## 基础概念

### **进程**

  > **进程**是一个具有一定独立功能的程序在一个数据集上的一次动态执行的过程，是**操作系统进行资源分配和调度的一个独立单位**，是应用程序运行的载体。

### **线程**

  > **线程**是程序执行中一个单一的顺序控制流程，是**程序执行流的最小单元**。s

### 关于两者

  | 小比喻                                | 关系                                                              |
  | -------------------------------------| ------------------------------------------------------------------|
  | 进程是一个工厂，工厂有它的独立资源      | 系统分配的内存（独立的一块内存）                                     |
  | 工厂之间相互独立                       | 进程之间相互独立                                                   |
  | 线程是工厂中的工人，多个工人协作完成任务 | 多个线程在进程中协作完成任务                                        |
  | 工厂内有一个或多个工人                 | 一个进程由一个或多个线程组成                                        |
  | 工人之间共享空间                       | 同一进程下的各个线程之间共享程序的内存空间（包括代码段、数据集、堆等）  |

  所以总结一下几点联系

  - 进程是操作系统**分配资源的最小单位**，线程是**程序执行的最小单位**。
  - 一个进程由一个或多个线程组成，线程是一个进程中代码的不同执行路线；
  - **进程之间相互独立**，但同一进程下的各个**线程之间共享程序的内存空间**(包括代码段、数据集、堆等)及一些进程级的资源(如打开文件和信号)。
  - 调度和切换：线程上下文切换比进程上下文切换要快得多。

### 多线程 & 多进程

  - **多进程**：在同一个时间里，同一个计算机系统中如果允许两个或两个以上的进程处于运行状态。多进程带来的好处是明显的，比如你可以听歌的同时，打开编辑器敲代码，编辑器和听歌软件的进程之间丝毫不会相互干扰
  - **多线程**：程序中包含多个执行流，即在一个程序中可以同时运行多个不同的线程来执行不同的任务，也就是说允许单个程序创建多个并行执行的线程来完成各自的任务。

## 浏览器是多进程的

 ### 主要包含哪些进程？ 

  - **Browser 进程**：浏览器的主进程（负责协调、主控），只有一个

    - 负责浏览器界面显示，与用户交互。如前进，后退等
    - 负责各个页面的管理，创建和销毁其他进程
    - 将Renderer进程得到的内存中的Bitmap，绘制到用户界面上
    - 网络资源的管理，下载等

  - **第三方插件进程**：每种类型的插件对应一个进程，仅当使用该插件时才创建
  - **GPU进程**：最多一个，用于3D绘制等
  - **浏览器渲染进程（浏览器内核）**（ Renderer 进程，内部是多线程的）：默认每个Tab页面一个进程，互不影响。主要作用为 页面渲染，脚本执行，事件处理等

 ### 多进程的优势

  - 避免单个page crash影响整个浏览器，比如，某个Tab页崩溃了，不会影响了整个浏览器

  - 避免第三方插件crash影响整个浏览器

  - 多进程充分利用多核优势

  - 方便使用沙盒模型隔离插件等进程，提高浏览器稳定性
  
 ### 注意

  - 在浏览器中打开一个**tab网页**相当于新起了一个进程（进程内有自己的多线程）

  - **浏览器内核是多线程**

---

## 浏览器内核是多线程的

 浏览器内核是多线程，在内核控制下各线程相互配合以保持同步，一个浏览器通常由以下常驻线程组成：

 - GUI 渲染线程
 - JavaScript 引擎线程
 - 定时触发器线程
 - 事件触发线程
 - 异步 http 请求线程

 ### GUI 渲染线程

  - 负责渲染浏览器界面，解析HTML，CSS，构建 DOM树 和RenderObject树，布局和绘制等。

  - 当界面需要重绘（Repaint）或由于某种操作引发回流(reflow)时，该线程就会执行

  - 注意，GUI渲染线程与JS引擎线程是**互斥**的，当JS引擎执行时GUI线程会被挂起（相当于被冻结了），GUI更新会被保存在**一个队列中等到JS引擎空闲时**立即被执行。

 ### Javascript引擎线程 
 
---
## 参考

- [浏览器进程？线程？傻傻分不清楚！](http://imweb.io/topic/58e3bfa845e5c13468f567d5)

- [从浏览器多进程到JS单线程，JS运行机制最全面的一次梳理](https://juejin.im/post/5a6547d0f265da3e283a1df7)


<style>
 ul:first-child {
   position: fixed;
   top: 10px;
   right: 50px;
 }
</style>